@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Colors - Light Mode */
    --color-surface: 255 255 255;
    --color-surface-secondary: 250 250 250;
    --color-surface-tertiary: 245 245 245;
    --color-primary: 23 23 23;
    --color-secondary: 115 115 115;
    --color-muted: 163 163 163;
    --color-border: 229 229 229;
    --color-border-strong: 212 212 212;

    /* Accent Colors */
    --color-accent: 5 150 105;
    --color-accent-hover: 4 120 87;
    --color-accent-light: 209 250 229;
    --color-accent-muted: 167 243 208;

    /* Semantic Colors */
    --color-success: 22 163 74;
    --color-success-light: 220 252 231;
    --color-error: 220 38 38;
    --color-error-light: 254 226 226;
    --color-warning: 202 138 4;
    --color-warning-light: 254 249 195;

    /* Interactive */
    --color-focus-ring: 5 150 105;

    /* Shadows */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

    /* Radii */
    --radius-sm: 0.375rem;
    --radius-md: 0.5rem;
    --radius-lg: 0.75rem;
    --radius-xl: 1rem;
    --radius-2xl: 1.25rem;

    /* Animations */
    --duration-fast: 150ms;
    --duration-normal: 200ms;
    --duration-slow: 300ms;
    --ease-out: cubic-bezier(0.33, 1, 0.68, 1);
    --ease-in-out: cubic-bezier(0.65, 0, 0.35, 1);
  }

  .dark {
    /* Colors - Dark Mode */
    --color-surface: 23 23 23;
    --color-surface-secondary: 38 38 38;
    --color-surface-tertiary: 64 64 64;
    --color-primary: 250 250 250;
    --color-secondary: 163 163 163;
    --color-muted: 115 115 115;
    --color-border: 64 64 64;
    --color-border-strong: 82 82 82;

    /* Accent Colors */
    --color-accent: 52 211 153;
    --color-accent-hover: 110 231 183;
    --color-accent-light: 6 78 59;
    --color-accent-muted: 4 120 87;

    /* Semantic Colors */
    --color-success: 74 222 128;
    --color-success-light: 20 83 45;
    --color-error: 248 113 113;
    --color-error-light: 127 29 29;
    --color-warning: 250 204 21;
    --color-warning-light: 113 63 18;

    /* Interactive */
    --color-focus-ring: 52 211 153;

    /* Shadows - slightly lighter for dark mode */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.3);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.3);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4), 0 8px 10px -6px rgb(0 0 0 / 0.3);
  }

  /* Base element styles */
  * {
    @apply border-border;
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    @apply bg-surface text-primary;
  }

  /* Focus visible utility */
  .focus-ring {
    @apply outline-none ring-2 ring-focus-ring ring-offset-2 ring-offset-surface;
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
    }
  }
}

@layer components {
  /* Skip link for accessibility */
  .skip-link {
    @apply absolute -top-10 left-4 z-[100] bg-surface px-4 py-2 text-sm font-medium text-primary rounded-md shadow-lg transition-all duration-200;
    @apply focus:top-4 focus:outline-none focus:ring-2 focus:ring-accent;
  }

  /* Button base styles */
  .btn {
    @apply inline-flex items-center justify-center rounded-xl font-medium transition-all duration-200;
    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-focus-ring focus-visible:ring-offset-2 focus-visible:ring-offset-surface;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
    @apply active:scale-[0.98];
  }

  .btn-primary {
    @apply btn bg-primary text-surface hover:bg-secondary;
  }

  .btn-accent {
    @apply btn bg-accent text-white hover:bg-accent-hover;
  }

  .btn-secondary {
    @apply btn border border-border bg-surface text-primary hover:bg-surface-secondary;
  }

  /* Input styles */
  .input {
    @apply w-full rounded-xl border border-border bg-surface px-4 py-3 text-sm text-primary;
    @apply placeholder:text-muted;
    @apply transition-all duration-200;
    @apply focus:border-accent focus:outline-none focus:ring-2 focus:ring-accent/20;
    @apply disabled:cursor-not-allowed disabled:bg-surface-secondary disabled:opacity-50;
  }

  /* Card styles */
  .card {
    @apply rounded-2xl border border-border bg-surface p-6;
    @apply shadow-sm transition-shadow duration-200;
  }

  .card-elevated {
    @apply card shadow-md hover:shadow-lg;
  }

  /* Skeleton loading */
  .skeleton {
    @apply animate-pulse rounded-md bg-surface-tertiary;
  }

  /* Dialog backdrop */
  .dialog-backdrop {
    @apply fixed inset-0 z-50 bg-black/40 backdrop-blur-sm;
    @apply animate-in fade-in duration-200;
  }

  /* Dialog content */
  .dialog-content {
    @apply fixed left-1/2 top-1/2 z-50 w-full max-w-md -translate-x-1/2 -translate-y-1/2;
    @apply rounded-2xl bg-surface p-6 shadow-xl;
    @apply animate-in fade-in zoom-in-95 duration-200;
  }

  /* Message bubbles */
  .message-bubble {
    @apply max-w-[min(36rem,100%)] rounded-2xl px-4 py-3 text-sm leading-relaxed;
    @apply animate-in fade-in slide-in-from-bottom-2 duration-300;
  }

  .message-user {
    @apply message-bubble bg-primary text-surface;
  }

  .message-assistant {
    @apply message-bubble bg-surface-secondary text-primary;
  }

  /* Phase indicator */
  .phase-step {
    @apply flex h-10 w-10 items-center justify-center rounded-xl text-sm font-semibold;
    @apply transition-all duration-300;
  }

  .phase-step-complete {
    @apply phase-step border-2 border-success bg-success-light text-success;
  }

  .phase-step-current {
    @apply phase-step border-2 border-accent bg-accent-light text-accent;
  }

  .phase-step-upcoming {
    @apply phase-step border border-border bg-surface text-muted;
  }

  /* Typing indicator */
  .typing-dot {
    @apply h-2 w-2 rounded-full bg-muted;
    animation: typing 1.4s infinite ease-in-out both;
  }

  .typing-dot:nth-child(1) {
    animation-delay: -0.32s;
  }

  .typing-dot:nth-child(2) {
    animation-delay: -0.16s;
  }

  @keyframes typing {
    0%, 80%, 100% {
      transform: scale(0.6);
      opacity: 0.4;
    }
    40% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Celebration animation */
  .celebrate {
    animation: celebrate 0.6s ease-out;
  }

  @keyframes celebrate {
    0% {
      transform: scale(0.8);
      opacity: 0;
    }
    50% {
      transform: scale(1.05);
    }
    100% {
      transform: scale(1);
      opacity: 1;
    }
  }

  /* Confetti particle */
  .confetti {
    position: fixed;
    pointer-events: none;
    animation: confetti-fall 3s ease-out forwards;
  }

  @keyframes confetti-fall {
    0% {
      transform: translateY(-100vh) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(100vh) rotate(720deg);
      opacity: 0;
    }
  }

  /* Page transition */
  .page-enter {
    @apply animate-in fade-in slide-in-from-bottom-4 duration-300;
  }

  /* Stagger children animation */
  .stagger-children > * {
    @apply animate-in fade-in slide-in-from-bottom-2;
  }

  .stagger-children > *:nth-child(1) { animation-delay: 0ms; }
  .stagger-children > *:nth-child(2) { animation-delay: 50ms; }
  .stagger-children > *:nth-child(3) { animation-delay: 100ms; }
  .stagger-children > *:nth-child(4) { animation-delay: 150ms; }
  .stagger-children > *:nth-child(5) { animation-delay: 200ms; }
}

@layer utilities {
  /* Text balance for headings */
  .text-balance {
    text-wrap: balance;
  }

  /* Animation utilities */
  .animate-in {
    animation-duration: var(--duration-normal);
    animation-timing-function: var(--ease-out);
    animation-fill-mode: both;
  }

  .fade-in {
    animation-name: fadeIn;
  }

  .fade-out {
    animation-name: fadeOut;
  }

  .slide-in-from-bottom-2 {
    --tw-translate-y: 0.5rem;
    animation-name: slideInFromBottom;
  }

  .slide-in-from-bottom-4 {
    --tw-translate-y: 1rem;
    animation-name: slideInFromBottom;
  }

  .zoom-in-95 {
    animation-name: zoomIn95;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes fadeOut {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  @keyframes slideInFromBottom {
    from {
      opacity: 0;
      transform: translateY(var(--tw-translate-y));
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes zoomIn95 {
    from {
      opacity: 0;
      transform: translate(-50%, -50%) scale(0.95);
    }
    to {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
    }
  }

  /* Duration utilities */
  .duration-fast {
    animation-duration: var(--duration-fast);
  }

  .duration-normal {
    animation-duration: var(--duration-normal);
  }

  .duration-slow {
    animation-duration: var(--duration-slow);
  }
}
